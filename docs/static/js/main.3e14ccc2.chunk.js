(this["webpackJsonpaibrush-frontend"]=this["webpackJsonpaibrush-frontend"]||[]).push([[0],{118:function(e,t){},122:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),c=a(19),s=a.n(c),i=(a(74),a(3)),o=a.n(i),u=a(4),l=a(7),d=a(10),b=a.n(d),j=a(17),f=a(8),h=(a(95),a(96),a(20));var p=a(0),m=function(e){var t=Object(n.useState)(""),a=Object(l.a)(t,2),r=a[0],c=a[1],s=Object(n.useState)(!1),i=Object(l.a)(s,2),d=i[0],b=i[1],j=Object(n.useState)(""),f=Object(l.a)(j,2),h=f[0],m=f[1],O=Object(n.useState)(""),v=Object(l.a)(O,2),g=v[0],x=v[1],y=function(){var t=Object(u.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(x(""),r.match(/^[^@]+@[^@]+\.[^@]+$/)){t.next=4;break}return x("Invalid email address"),t.abrupt("return");case 4:return t.next=6,e.client.login({email:r});case 6:b(!0);case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),w=function(){var t=Object(u.a)(o.a.mark((function t(){var a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return x(""),t.prev=1,t.next=4,e.client.verify({email:r,code:h});case 4:a=t.sent,e.onLogin(a.data),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(1),console.error(t.t0),x("Failed to verify code");case 12:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(){return t.apply(this,arguments)}}();return Object(p.jsx)("div",{className:"container",children:Object(p.jsx)("div",{className:"row",children:Object(p.jsx)("div",{className:"col-md-6 offset-md-3",children:Object(p.jsx)("div",{className:"card",children:Object(p.jsxs)("div",{className:"card-body",children:[Object(p.jsx)("h5",{className:"card-title",children:"Login"}),g&&Object(p.jsx)("p",{className:"text-danger",children:g}),d&&Object(p.jsxs)("div",{children:[Object(p.jsxs)("div",{className:"form-group",children:[Object(p.jsx)("label",{htmlFor:"verifyCode",children:"Verify Code"}),Object(p.jsx)("input",{type:"text",className:"form-control",id:"verifyCode",placeholder:"Verification Code",value:h,onChange:function(e){return m(e.target.value)}})]}),Object(p.jsx)("button",{className:"btn btn-secondary",onClick:function(){return b(!1)},children:"Cancel"}),"\xa0",Object(p.jsx)("button",{type:"button",className:"btn btn-primary",onClick:function(e){e.preventDefault(),w()},children:"Verify"})]}),!d&&Object(p.jsxs)("div",{children:[Object(p.jsxs)("div",{className:"form-group",children:[Object(p.jsx)("label",{htmlFor:"email",children:"Email address"}),Object(p.jsx)("input",{type:"email",className:"form-control",id:"email","aria-describedby":"emailHelp",placeholder:"Enter email",value:r,onChange:function(e){return c(e.target.value)}}),Object(p.jsx)("small",{id:"emailHelp",className:"form-text text-muted",children:"We'll never share your email with anyone else."})]}),Object(p.jsx)("button",{type:"button",className:"btn btn-primary",onClick:function(e){e.preventDefault(),y()},children:"Login"})]})]})})})})})},O=function(){return Object(p.jsxs)("div",{className:"container",children:[Object(p.jsx)("div",{className:"row",children:Object(p.jsx)("div",{className:"col-12",children:Object(p.jsx)("h1",{children:"Welcome to AIBrush!"})})}),Object(p.jsx)("div",{className:"row",children:Object(p.jsx)("div",{className:"col-12",children:Object(p.jsx)("div",{className:"spacer"})})}),Object(p.jsx)("div",{className:"row",children:Object(p.jsx)("div",{className:"col-sm-12",children:Object(p.jsxs)("div",{className:"btn-group-vertical",children:[Object(p.jsxs)(j.b,{to:"/create-image",className:"btn btn-primary",children:[Object(p.jsx)("i",{className:"fas fa-image"}),"\xa0 Create a new image"]}),Object(p.jsxs)(j.b,{to:"/images",className:"btn btn-primary",children:[Object(p.jsx)("i",{className:"fas fa-folder-open"}),"\xa0 My Images"]}),Object(p.jsxs)(j.b,{to:"/designer",className:"btn btn-primary",children:[Object(p.jsx)("i",{className:"fas fa-pencil-alt"}),"\xa0 Interactive Designer"]})]})})})]})},v=a(64),g=a(27),x=a(45),y=a.n(x),w=a(34),N=function(e){var t=e.apiUrl,a=e.image,r=e.onClick,c=e.onDelete,s=e.onFork,i=e.onDesign,o="".concat(t,"/images/").concat(a.id,"/thumbnail.jpg?updated_at=").concat(a.updated_at);return Object(n.useEffect)((function(){var e=document.getElementById("image-".concat(a.id));e.onerror=function(){e.src="/images/default.jpg"}})),Object(p.jsxs)("div",{className:"card",style:{padding:"10px",width:"200px",margin:"10px"},children:[Object(p.jsx)("img",{style:{cursor:"pointer"},id:"image-".concat(a.id),className:"card-img-top",src:o,alt:a.label,onClick:function(){return r(a)}}),Object(p.jsxs)("div",{className:"card-body",children:[Object(p.jsxs)("div",{children:[Object(p.jsx)("h5",{className:"card-title",children:a.label}),Object(p.jsxs)("p",{className:"card-text",children:[Object(p.jsx)("i",{className:Object(w.a)(a.status)}),"\xa0",a.status]}),"processing"===a.status&&Object(p.jsx)("div",{className:"progress",children:Object(p.jsx)("div",{className:"progress-bar",role:"progressbar",style:{width:"".concat(1*a.current_iterations/a.iterations*100,"%")}})})]}),Object(p.jsx)("hr",{}),c&&Object(p.jsx)("button",{className:"btn btn-danger btn-sm",onClick:function(){return c&&c(a)},style:{marginRight:"5px"},children:Object(p.jsx)("i",{className:"fas fa-trash-alt"})}),s&&("completed"===a.status||"saved"===a.status)&&Object(p.jsx)("button",{className:"btn btn-secondary btn-sm",onClick:function(){return s&&s(a)},style:{marginRight:"5px"},children:Object(p.jsx)("i",{className:"fas fa-code-branch"})}),i&&Object(p.jsx)("button",{className:"btn btn-secondary btn-sm",onClick:function(){return i&&i(a)},style:{marginRight:"5px"},children:Object(p.jsx)("i",{className:"fas fa-pencil-alt"})}),("completed"===a.status||"saved"===a.status)&&a.enable_video&&Object(p.jsx)("button",{className:"btn btn-secondary btn-sm",onClick:function(){return window.open("".concat(t,"/images/").concat(a.id,"/video.mp4"))},style:{marginRight:"5px",marginTop:"5px"},children:Object(p.jsx)("i",{className:"fas fa-video"})})]})]})},k=a(28),I=function(e){var t=e.apiUrl,a=e.image,r=e.onClose,c=e.onDelete,s=e.onDesign,i=e.onFork,o=Object(n.useRef)(null),u="".concat(t,"/images/").concat(a.id,"/image.jpg?updated_at=").concat(a.updated_at);return Object(n.useEffect)((function(){o.current&&(o.current.onerror=function(){o.current&&(o.current.src="/images/default.jpg")})}),[o]),Object(p.jsxs)(k.a,{show:!0,onHide:r,size:"lg",children:[Object(p.jsx)(k.a.Header,{closeButton:!0,children:Object(p.jsx)(k.a.Title,{children:a.label})}),Object(p.jsxs)(k.a.Body,{children:[Object(p.jsx)("img",{ref:o,style:{width:"100%"},id:"image-popup-".concat(a.id),src:u,alt:a.label}),Object(p.jsx)("div",{className:"row",children:Object(p.jsxs)("div",{className:"col-lg-12",children:[Object(p.jsxs)("p",{children:["Status: ",a.status]}),Object(p.jsxs)("p",{children:["Iterations: ",a.iterations]}),Object(p.jsxs)("p",{children:["Phrases: ",a.phrases.join(", ")]}),Object(p.jsxs)("p",{children:["Enable Video: ",a.enable_video?"Yes":"No"]}),a.enable_video&&Object(p.jsxs)("p",{children:["Enable Zoom: ",a.enable_zoom?"Yes":"No"]}),a.enable_zoom&&a.enable_zoom&&Object(p.jsxs)("p",{children:["Zoom Frequency: ",a.zoom_frequency]}),a.enable_zoom&&a.enable_zoom&&Object(p.jsxs)("p",{children:["Zoom Scale: ",a.zoom_scale]}),a.enable_zoom&&a.enable_zoom&&Object(p.jsxs)("p",{children:["Zoom Shift X: ",a.zoom_shift_x]}),a.enable_zoom&&a.enable_zoom&&Object(p.jsxs)("p",{children:["Zoom Shift Y: ",a.zoom_shift_y]})]})}),Object(p.jsx)("div",{className:"row",children:Object(p.jsxs)("div",{className:"col-lg-12",children:[c&&Object(p.jsx)("button",{className:"btn btn-danger btn-sm",onClick:function(){return c&&c(a)},style:{marginRight:"5px"},children:Object(p.jsx)("i",{className:"fas fa-trash-alt"})}),i&&"saved"===a.status&&Object(p.jsx)("button",{className:"btn btn-secondary btn-sm",onClick:function(){return i&&i(a)},style:{marginRight:"5px"},children:Object(p.jsx)("i",{className:"fas fa-code-branch"})}),s&&Object(p.jsx)("button",{className:"btn btn-secondary btn-sm",onClick:function(){return s&&s(a)},style:{marginRight:"5px"},children:Object(p.jsx)("i",{className:"fas fa-pencil-alt"})}),("completed"===a.status||"saved"===a.status)&&a.enable_video&&Object(p.jsx)("button",{className:"btn btn-secondary btn-sm",onClick:function(){return window.open("".concat(t,"/images/").concat(a.id,"/video.mp4"))},style:{marginRight:"5px",marginTop:"5px"},children:Object(p.jsx)("i",{className:"fas fa-video"})})]})})]})]})},C=a(23),_=function(e){var t=e.onLoadMore,a=e.isLoading;return Object(p.jsx)("div",{className:"card",style:{padding:"10px",width:"200px",margin:"10px"},children:Object(p.jsx)("div",{className:"card-body",children:Object(p.jsx)("button",{disabled:a,className:"btn btn-primary",onClick:t,children:a?Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("i",{className:"fa fa-spinner fa-spin"})," Loading..."]}):Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("i",{className:"fa fa-plus"})," Load more"]})})})})},S=function(e){var t=e.api,a=e.apiUrl,r=Object(f.f)(),c=Object(n.useState)([]),s=Object(l.a)(c,2),i=s[0],d=s[1],b=Object(n.useState)(null),h=Object(l.a)(b,2),m=h[0],O=h[1],v=Object(n.useState)(null),x=Object(l.a)(v,2),w=x[0],k=x[1],S=Object(n.useState)(!1),T=Object(l.a)(S,2),z=T[0],D=T[1],R=function(){var e=Object(u.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.push("/create-image?parent=".concat(t.id));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){t&&function(){var e=Object(u.a)(o.a.mark((function e(){var a,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O(null),e.prev=1,a=y()().add(1,"minutes").valueOf(),e.next=5,t.listImages(a,100,"desc");case 5:return(n=e.sent).data.images&&d(n.data.images),e.abrupt("return",0);case 10:e.prev=10,e.t0=e.catch(1),O("Could not load images"),console.error(e.t0);case 14:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(){return e.apply(this,arguments)}}()()}),[t]),Object(n.useEffect)((function(){if(t){var e=function(){var e=Object(u.a)(o.a.mark((function e(a){var n,r,c,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O(null),n=a.reduce((function(e,t){return Math.max(e,t.updated_at)}),0),e.prev=2,e.next=5,t.listImages(n+1,100,"asc");case 5:return(r=e.sent).data.images&&(c=r.data.images.filter((function(e){return a.findIndex((function(t){return t.id===e.id}))<0})),s=r.data.images.filter((function(e){return a.findIndex((function(t){return t.id===e.id}))>=0})),d([].concat(Object(g.a)(a.map((function(e){var t=s.find((function(t){return t.id===e.id}));return t||e}))),Object(g.a)(c)).sort((function(e,t){return t.updated_at-e.updated_at})))),e.abrupt("return",a);case 10:e.prev=10,e.t0=e.catch(2),O("Could not load images"),console.error(e.t0);case 14:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t){return e.apply(this,arguments)}}(),a=setInterval((function(){e(i)}),5e3);return function(){clearInterval(a)}}}),[t,i]);var E=function(){var e=Object(u.a)(o.a.mark((function e(a){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O(""),e.prev=1,e.next=4,t.deleteImage(a.id);case 4:d((function(e){return e.filter((function(e){return e.id!==a.id}))})),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),console.error(e.t0),O("Could not delete image");case 11:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}(),U=function(){var e=Object(u.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(C.b)(t.id),r.push("/designer");case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),P=function(){var e=Object(u.a)(o.a.mark((function e(){var a,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return D(!0),e.prev=1,a=y()().valueOf(),i.forEach((function(e){a=Math.min(a,e.updated_at)})),e.next=6,t.listImages(a-1,100,"desc");case 6:(n=e.sent).data.images&&d([].concat(Object(g.a)(i),Object(g.a)(n.data.images)).sort((function(e,t){return t.updated_at-e.updated_at})));case 8:return e.prev=8,D(!1),e.finish(8);case 11:case"end":return e.stop()}}),e,null,[[1,,8,11]])})));return function(){return e.apply(this,arguments)}}();return Object(p.jsxs)("div",{className:"container",children:[Object(p.jsx)("div",{className:"row",children:Object(p.jsx)("div",{className:"col-md-12",children:Object(p.jsx)("h1",{children:"Images"})})}),m&&Object(p.jsx)("div",{className:"row",children:Object(p.jsx)("div",{className:"col-12",children:Object(p.jsx)("div",{className:"alert alert-danger",role:"alert",children:m})})}),Object(p.jsx)("div",{className:"row",children:Object(p.jsx)("div",{className:"col-12",children:Object(p.jsxs)(j.b,{to:"/create-image",className:"btn btn-primary",children:[Object(p.jsx)("i",{className:"fas fa-plus"}),"\xa0 Create Image"]})})}),Object(p.jsx)("hr",{}),Object(p.jsx)("div",{className:"row",children:Object(p.jsx)("div",{className:"col-md-12",children:Object(p.jsxs)("div",{className:"row",children:[i.map((function(e){return Object(p.jsx)(N,{onDelete:E,onFork:R,onClick:k,onDesign:U,apiUrl:a,image:e},e.id)})),Object(p.jsx)(_,{isLoading:z,onLoadMore:P})]})})}),w&&Object(p.jsx)(I,{apiUrl:a,image:w,onClose:function(){return k(null)},onDelete:E,onFork:R,onDesign:U})]})},T=function(e){var t=e.onCredentialsRefreshed,a=e.api,r=e.credentials;return Object(n.useEffect)((function(){var e=setInterval((function(){r&&r.refreshToken&&a.refresh({refreshToken:r.refreshToken}).then((function(e){t(e.data)}))}),3e5);return function(){clearInterval(e)}}),[r,a,t]),Object(p.jsx)("div",{})},z=function(e){var t=e.api,a=Object(n.useState)(!0),r=Object(l.a)(a,2),c=r[0],s=r[1];return Object(n.useEffect)((function(){var e=setInterval((function(){t.healthcheck().then((function(){return s(!0)})).catch((function(){return s(!1)}))}),5e3);return function(){return clearInterval(e)}}),[t]),Object(p.jsx)("div",{className:"alert alert-danger",role:"alert",style:{display:c?"none":"block"},children:Object(p.jsx)("strong",{children:"Service is unavailable"})})},D=a(67),R={apiUrl:"https://aibrush.ngrok.io"},E=b.a,U=new h.a(void 0,localStorage.getItem("apiUrl")||R.apiUrl,E);function P(e){e.accessToken&&(E.defaults.headers.common.Authorization="Bearer ".concat(e.accessToken))}var L=function(){var e=Object(n.useState)(null),t=Object(l.a)(e,2),a=t[0],r=t[1],c=function(){var e=Object(u.a)(o.a.mark((function e(){var t,a,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("App.init"),!(t=localStorage.getItem("credentials"))){e.next=16;break}return e.prev=3,a=JSON.parse(t),e.next=7,U.refresh({refreshToken:a.refreshToken});case 7:n=e.sent,r(n.data),localStorage.setItem("credentials",JSON.stringify(n.data)),P(n.data),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[3,13]])})));return function(){return e.apply(this,arguments)}}(),s=function(){var e=Object(u.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:localStorage.setItem("credentials",JSON.stringify(t)),r(t),P(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){c()}),[]),Object(p.jsxs)("div",{className:"App",children:[Object(p.jsx)(T,{api:U,credentials:a,onCredentialsRefreshed:s}),Object(p.jsx)(z,{api:U}),Object(p.jsxs)("button",{className:"btn btn-primary top-button",onClick:function(){var e=localStorage.getItem("apiUrl")||R.apiUrl,t=prompt("Configure backend url",e);t&&(e=t,localStorage.setItem("apiUrl",e),window.location.reload())},children:[Object(p.jsx)("i",{className:"fas fa-cog"}),"\xa0 Settings"]}),Object(p.jsxs)(j.a,{children:[!a&&Object(p.jsx)(m,{httpClient:E,client:U,onLogin:s}),a&&Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)("button",{className:"btn btn-primary top-button",onClick:function(){return r(null)},children:[Object(p.jsx)("i",{className:"fas fa-sign-out-alt"}),"\xa0 Logout"]}),Object(p.jsxs)(j.b,{className:"btn btn-primary top-button",to:"/",children:[Object(p.jsx)("i",{className:"fas fa-home"}),"\xa0 Home"]})]}),a&&Object(p.jsxs)(f.c,{children:[Object(p.jsx)(f.a,{path:"/",exact:!0,children:Object(p.jsx)(O,{})}),Object(p.jsx)(f.a,{path:"/create-image",children:Object(p.jsx)(v.a,{api:U,apiUrl:R.apiUrl})}),Object(p.jsx)(f.a,{path:"/images",children:Object(p.jsx)(S,{apiUrl:R.apiUrl,api:U})}),Object(p.jsx)(f.a,{path:"/designer",children:Object(p.jsx)(D.a,{api:U,apiUrl:R.apiUrl})})]})]})]})},q=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,124)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,c=t.getLCP,s=t.getTTFB;a(e),n(e),r(e),c(e),s(e)}))};s.a.render(Object(p.jsx)(r.a.StrictMode,{children:Object(p.jsx)(L,{})}),document.getElementById("root")),q()},20:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return _}));var n,r,c,s=a(25),i=a(60),o=a(30),u=a(35),l=a(3),d=a.n(l),b=a(2),j=a(4),f=a(10),h=a.n(f),p=a(61),m=a(68),O="https://aibrush.ngrok.io".replace(/\/+$/,""),v=function e(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:O,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:h.a;Object(s.a)(this,e),this.basePath=a,this.axios=n,this.configuration=void 0,t&&(this.configuration=t,this.basePath=t.basePath||this.basePath)},g=function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(e,n){var r;return Object(s.a)(this,a),(r=t.call(this,n)).field=e,r.name="RequiredError",r}return a}(Object(m.a)(Error)),x="https://example.com",y=function(e,t,a){if(null===a||void 0===a)throw new g(t,"Required parameter ".concat(t," was null or undefined when calling ").concat(e,"."))},w=function(e){for(var t=new URLSearchParams(e.search),a=arguments.length,n=new Array(a>1?a-1:0),r=1;r<a;r++)n[r-1]=arguments[r];for(var c=0,s=n;c<s.length;c++){var i=s[c];for(var o in i)if(Array.isArray(i[o])){t.delete(o);var u,l=Object(p.a)(i[o]);try{for(l.s();!(u=l.n()).done;){var d=u.value;t.append(o,d)}}catch(b){l.e(b)}finally{l.f()}}else t.set(o,i[o])}e.search=t.toString()},N=function(e,t,a){var n="string"!==typeof e;return(n&&a&&a.isJsonMime?a.isJsonMime(t.headers["Content-Type"]):n)?JSON.stringify(void 0!==e?e:{}):e||""},k=function(e){return e.pathname+e.search+e.hash},I=function(e,t,a,n){return function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a,s=Object(b.a)(Object(b.a)({},e.options),{},{url:((null===n||void 0===n?void 0:n.basePath)||c)+e.url});return r.request(s)}};!function(e){e.Ok="ok"}(n||(n={})),function(e){e.Pending="pending",e.Processing="processing",e.Completed="completed",e.Saved="saved"}(r||(r={})),function(e){e.Pending="pending",e.Processing="processing",e.Completed="completed",e.Saved="saved"}(c||(c={}));var C=function(e){var t=function(e){return{createImage:function(){var t=Object(j.a)(d.a.mark((function t(a){var n,r,c,s,i,o,u,l=arguments;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=l.length>1&&void 0!==l[1]?l[1]:{},r=new URL("/images",x),e&&(c=e.baseOptions),s=Object(b.a)(Object(b.a)({method:"POST"},c),n),o={},(i={})["Content-Type"]="application/json",w(r,o,n.query),u=c&&c.headers?c.headers:{},s.headers=Object(b.a)(Object(b.a)(Object(b.a)({},i),u),n.headers),s.data=N(a,s,e),t.abrupt("return",{url:k(r),options:s});case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),deleteImage:function(){var t=Object(j.a)(d.a.mark((function t(a){var n,r,c,s,i,o,u,l=arguments;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=l.length>1&&void 0!==l[1]?l[1]:{},y("deleteImage","id",a),r="/images/{id}".replace("{".concat("id","}"),encodeURIComponent(String(a))),c=new URL(r,x),e&&(s=e.baseOptions),i=Object(b.a)(Object(b.a)({method:"DELETE"},s),n),o={},w(c,{},n.query),u=s&&s.headers?s.headers:{},i.headers=Object(b.a)(Object(b.a)(Object(b.a)({},o),u),n.headers),t.abrupt("return",{url:k(c),options:i});case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),getImage:function(){var t=Object(j.a)(d.a.mark((function t(a,n){var r,c,s,i,o,u,l,j,f=arguments;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=f.length>2&&void 0!==f[2]?f[2]:{},y("getImage","id",a),c="/images/{id}".replace("{".concat("id","}"),encodeURIComponent(String(a))),s=new URL(c,x),e&&(i=e.baseOptions),o=Object(b.a)(Object(b.a)({method:"GET"},i),r),u={},l={},void 0!==n&&(l.download=n),w(s,l,r.query),j=i&&i.headers?i.headers:{},o.headers=Object(b.a)(Object(b.a)(Object(b.a)({},u),j),r.headers),t.abrupt("return",{url:k(s),options:o});case 13:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),getImageData:function(){var t=Object(j.a)(d.a.mark((function t(a){var n,r,c,s,i,o,u,l=arguments;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=l.length>1&&void 0!==l[1]?l[1]:{},y("getImageData","id",a),r="/images/{id}/image.jpg".replace("{".concat("id","}"),encodeURIComponent(String(a))),c=new URL(r,x),e&&(s=e.baseOptions),i=Object(b.a)(Object(b.a)({method:"GET"},s),n),o={},w(c,{},n.query),u=s&&s.headers?s.headers:{},i.headers=Object(b.a)(Object(b.a)(Object(b.a)({},o),u),n.headers),t.abrupt("return",{url:k(c),options:i});case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),getThumbnailData:function(){var t=Object(j.a)(d.a.mark((function t(a){var n,r,c,s,i,o,u,l=arguments;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=l.length>1&&void 0!==l[1]?l[1]:{},y("getThumbnailData","id",a),r="/images/{id}/thumbnail.jpg".replace("{".concat("id","}"),encodeURIComponent(String(a))),c=new URL(r,x),e&&(s=e.baseOptions),i=Object(b.a)(Object(b.a)({method:"GET"},s),n),o={},w(c,{},n.query),u=s&&s.headers?s.headers:{},i.headers=Object(b.a)(Object(b.a)(Object(b.a)({},o),u),n.headers),t.abrupt("return",{url:k(c),options:i});case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),getVideoData:function(){var t=Object(j.a)(d.a.mark((function t(a){var n,r,c,s,i,o,u,l=arguments;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=l.length>1&&void 0!==l[1]?l[1]:{},y("getVideoData","id",a),r="/images/{id}/video.mp4".replace("{".concat("id","}"),encodeURIComponent(String(a))),c=new URL(r,x),e&&(s=e.baseOptions),i=Object(b.a)(Object(b.a)({method:"GET"},s),n),o={},w(c,{},n.query),u=s&&s.headers?s.headers:{},i.headers=Object(b.a)(Object(b.a)(Object(b.a)({},o),u),n.headers),t.abrupt("return",{url:k(c),options:i});case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),healthcheck:function(){var t=Object(j.a)(d.a.mark((function t(){var a,n,r,c,s,i,o=arguments;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=o.length>0&&void 0!==o[0]?o[0]:{},n=new URL("/healthcheck",x),e&&(r=e.baseOptions),c=Object(b.a)(Object(b.a)({method:"GET"},r),a),s={},w(n,{},a.query),i=r&&r.headers?r.headers:{},c.headers=Object(b.a)(Object(b.a)(Object(b.a)({},s),i),a.headers),t.abrupt("return",{url:k(n),options:c});case 11:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),listImages:function(){var t=Object(j.a)(d.a.mark((function t(a,n,r){var c,s,i,o,u,l,j,f=arguments;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=f.length>3&&void 0!==f[3]?f[3]:{},s=new URL("/images",x),e&&(i=e.baseOptions),o=Object(b.a)(Object(b.a)({method:"GET"},i),c),u={},l={},void 0!==a&&(l.cursor=a),void 0!==n&&(l.limit=n),void 0!==r&&(l.direction=r),w(s,l,c.query),j=i&&i.headers?i.headers:{},o.headers=Object(b.a)(Object(b.a)(Object(b.a)({},u),j),c.headers),t.abrupt("return",{url:k(s),options:o});case 14:case"end":return t.stop()}}),t)})));return function(e,a,n){return t.apply(this,arguments)}}(),login:function(){var t=Object(j.a)(d.a.mark((function t(a){var n,r,c,s,i,o,u,l=arguments;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=l.length>1&&void 0!==l[1]?l[1]:{},r=new URL("/auth/login",x),e&&(c=e.baseOptions),s=Object(b.a)(Object(b.a)({method:"POST"},c),n),o={},(i={})["Content-Type"]="application/json",w(r,o,n.query),u=c&&c.headers?c.headers:{},s.headers=Object(b.a)(Object(b.a)(Object(b.a)({},i),u),n.headers),s.data=N(a,s,e),t.abrupt("return",{url:k(r),options:s});case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),processImage:function(){var t=Object(j.a)(d.a.mark((function t(){var a,n,r,c,s,i,o=arguments;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=o.length>0&&void 0!==o[0]?o[0]:{},n=new URL("/process-image",x),e&&(r=e.baseOptions),c=Object(b.a)(Object(b.a)({method:"PUT"},r),a),s={},w(n,{},a.query),i=r&&r.headers?r.headers:{},c.headers=Object(b.a)(Object(b.a)(Object(b.a)({},s),i),a.headers),t.abrupt("return",{url:k(n),options:c});case 11:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),refresh:function(){var t=Object(j.a)(d.a.mark((function t(a){var n,r,c,s,i,o,u,l=arguments;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=l.length>1&&void 0!==l[1]?l[1]:{},r=new URL("/auth/refresh",x),e&&(c=e.baseOptions),s=Object(b.a)(Object(b.a)({method:"POST"},c),n),o={},(i={})["Content-Type"]="application/json",w(r,o,n.query),u=c&&c.headers?c.headers:{},s.headers=Object(b.a)(Object(b.a)(Object(b.a)({},i),u),n.headers),s.data=N(a,s,e),t.abrupt("return",{url:k(r),options:s});case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),updateImage:function(){var t=Object(j.a)(d.a.mark((function t(a,n){var r,c,s,i,o,u,l,j,f=arguments;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=f.length>2&&void 0!==f[2]?f[2]:{},y("updateImage","id",a),c="/images/{id}".replace("{".concat("id","}"),encodeURIComponent(String(a))),s=new URL(c,x),e&&(i=e.baseOptions),o=Object(b.a)(Object(b.a)({method:"PATCH"},i),r),l={},(u={})["Content-Type"]="application/json",w(s,l,r.query),j=i&&i.headers?i.headers:{},o.headers=Object(b.a)(Object(b.a)(Object(b.a)({},u),j),r.headers),o.data=N(n,o,e),t.abrupt("return",{url:k(s),options:o});case 14:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),updateVideoData:function(){var t=Object(j.a)(d.a.mark((function t(a,n){var r,c,s,i,o,u,l,j,f=arguments;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=f.length>2&&void 0!==f[2]?f[2]:{},y("updateVideoData","id",a),c="/images/{id}/video.mp4".replace("{".concat("id","}"),encodeURIComponent(String(a))),s=new URL(c,x),e&&(i=e.baseOptions),o=Object(b.a)(Object(b.a)({method:"PUT"},i),r),l={},(u={})["Content-Type"]="video/mp4",w(s,l,r.query),j=i&&i.headers?i.headers:{},o.headers=Object(b.a)(Object(b.a)(Object(b.a)({},u),j),r.headers),o.data=N(n,o,e),t.abrupt("return",{url:k(s),options:o});case 14:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),verify:function(){var t=Object(j.a)(d.a.mark((function t(a){var n,r,c,s,i,o,u,l=arguments;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=l.length>1&&void 0!==l[1]?l[1]:{},r=new URL("/auth/verify",x),e&&(c=e.baseOptions),s=Object(b.a)(Object(b.a)({method:"POST"},c),n),o={},(i={})["Content-Type"]="application/json",w(r,o,n.query),u=c&&c.headers?c.headers:{},s.headers=Object(b.a)(Object(b.a)(Object(b.a)({},i),u),n.headers),s.data=N(a,s,e),t.abrupt("return",{url:k(r),options:s});case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}(e);return{createImage:function(a,n){return Object(j.a)(d.a.mark((function r(){var c;return d.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.createImage(a,n);case 2:return c=r.sent,r.abrupt("return",I(c,h.a,O,e));case 4:case"end":return r.stop()}}),r)})))()},deleteImage:function(a,n){return Object(j.a)(d.a.mark((function r(){var c;return d.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.deleteImage(a,n);case 2:return c=r.sent,r.abrupt("return",I(c,h.a,O,e));case 4:case"end":return r.stop()}}),r)})))()},getImage:function(a,n,r){return Object(j.a)(d.a.mark((function c(){var s;return d.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,t.getImage(a,n,r);case 2:return s=c.sent,c.abrupt("return",I(s,h.a,O,e));case 4:case"end":return c.stop()}}),c)})))()},getImageData:function(a,n){return Object(j.a)(d.a.mark((function r(){var c;return d.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.getImageData(a,n);case 2:return c=r.sent,r.abrupt("return",I(c,h.a,O,e));case 4:case"end":return r.stop()}}),r)})))()},getThumbnailData:function(a,n){return Object(j.a)(d.a.mark((function r(){var c;return d.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.getThumbnailData(a,n);case 2:return c=r.sent,r.abrupt("return",I(c,h.a,O,e));case 4:case"end":return r.stop()}}),r)})))()},getVideoData:function(a,n){return Object(j.a)(d.a.mark((function r(){var c;return d.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.getVideoData(a,n);case 2:return c=r.sent,r.abrupt("return",I(c,h.a,O,e));case 4:case"end":return r.stop()}}),r)})))()},healthcheck:function(a){return Object(j.a)(d.a.mark((function n(){var r;return d.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.healthcheck(a);case 2:return r=n.sent,n.abrupt("return",I(r,h.a,O,e));case 4:case"end":return n.stop()}}),n)})))()},listImages:function(a,n,r,c){return Object(j.a)(d.a.mark((function s(){var i;return d.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,t.listImages(a,n,r,c);case 2:return i=s.sent,s.abrupt("return",I(i,h.a,O,e));case 4:case"end":return s.stop()}}),s)})))()},login:function(a,n){return Object(j.a)(d.a.mark((function r(){var c;return d.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.login(a,n);case 2:return c=r.sent,r.abrupt("return",I(c,h.a,O,e));case 4:case"end":return r.stop()}}),r)})))()},processImage:function(a){return Object(j.a)(d.a.mark((function n(){var r;return d.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.processImage(a);case 2:return r=n.sent,n.abrupt("return",I(r,h.a,O,e));case 4:case"end":return n.stop()}}),n)})))()},refresh:function(a,n){return Object(j.a)(d.a.mark((function r(){var c;return d.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.refresh(a,n);case 2:return c=r.sent,r.abrupt("return",I(c,h.a,O,e));case 4:case"end":return r.stop()}}),r)})))()},updateImage:function(a,n,r){return Object(j.a)(d.a.mark((function c(){var s;return d.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,t.updateImage(a,n,r);case 2:return s=c.sent,c.abrupt("return",I(s,h.a,O,e));case 4:case"end":return c.stop()}}),c)})))()},updateVideoData:function(a,n,r){return Object(j.a)(d.a.mark((function c(){var s;return d.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,t.updateVideoData(a,n,r);case 2:return s=c.sent,c.abrupt("return",I(s,h.a,O,e));case 4:case"end":return c.stop()}}),c)})))()},verify:function(a,n){return Object(j.a)(d.a.mark((function r(){var c;return d.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.verify(a,n);case 2:return c=r.sent,r.abrupt("return",I(c,h.a,O,e));case 4:case"end":return r.stop()}}),r)})))()}}},_=function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"createImage",value:function(e,t){var a=this;return C(this.configuration).createImage(e,t).then((function(e){return e(a.axios,a.basePath)}))}},{key:"deleteImage",value:function(e,t){var a=this;return C(this.configuration).deleteImage(e,t).then((function(e){return e(a.axios,a.basePath)}))}},{key:"getImage",value:function(e,t,a){var n=this;return C(this.configuration).getImage(e,t,a).then((function(e){return e(n.axios,n.basePath)}))}},{key:"getImageData",value:function(e,t){var a=this;return C(this.configuration).getImageData(e,t).then((function(e){return e(a.axios,a.basePath)}))}},{key:"getThumbnailData",value:function(e,t){var a=this;return C(this.configuration).getThumbnailData(e,t).then((function(e){return e(a.axios,a.basePath)}))}},{key:"getVideoData",value:function(e,t){var a=this;return C(this.configuration).getVideoData(e,t).then((function(e){return e(a.axios,a.basePath)}))}},{key:"healthcheck",value:function(e){var t=this;return C(this.configuration).healthcheck(e).then((function(e){return e(t.axios,t.basePath)}))}},{key:"listImages",value:function(e,t,a,n){var r=this;return C(this.configuration).listImages(e,t,a,n).then((function(e){return e(r.axios,r.basePath)}))}},{key:"login",value:function(e,t){var a=this;return C(this.configuration).login(e,t).then((function(e){return e(a.axios,a.basePath)}))}},{key:"processImage",value:function(e){var t=this;return C(this.configuration).processImage(e).then((function(e){return e(t.axios,t.basePath)}))}},{key:"refresh",value:function(e,t){var a=this;return C(this.configuration).refresh(e,t).then((function(e){return e(a.axios,a.basePath)}))}},{key:"updateImage",value:function(e,t,a){var n=this;return C(this.configuration).updateImage(e,t,a).then((function(e){return e(n.axios,n.basePath)}))}},{key:"updateVideoData",value:function(e,t,a){var n=this;return C(this.configuration).updateVideoData(e,t,a).then((function(e){return e(n.axios,n.basePath)}))}},{key:"verify",value:function(e,t){var a=this;return C(this.configuration).verify(e,t).then((function(e){return e(a.axios,a.basePath)}))}}]),a}(v)},23:function(e,t,a){"use strict";function n(){return localStorage.getItem("designerCurrentImageId")}function r(e){e?localStorage.setItem("designerCurrentImageId",e):localStorage.removeItem("designerCurrentImageId")}a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return r}))},33:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(7),r=a(1),c=a(28),s=a(0),i=function(e){var t=e.encodedImage,a=e.onSave,i=e.onCancel,o=Object(r.useState)(null),u=Object(n.a)(o,2),l=u[0],d=u[1],b=Object(r.useState)(null),j=Object(n.a)(b,2),f=j[0],h=j[1],p=Object(r.useState)(10),m=Object(n.a)(p,2),O=m[0],v=m[1],g=Object(r.useState)("#000000"),x=Object(n.a)(g,2),y=x[0],w=x[1],N=Object(r.useState)(!1),k=Object(n.a)(N,2),I=k[0],C=k[1],_=Object(r.useState)(0),S=Object(n.a)(_,2),T=S[0],z=S[1],D=Object(r.useState)(0),R=Object(n.a)(D,2),E=R[0],U=R[1];Object(r.useEffect)((function(){var e=document.getElementById("canvas");e&&(d(e),h(e.getContext("2d")))}),[l]),Object(r.useEffect)((function(){if(f&&l)if(t){var e=new Image;e.src=t,e.onload=function(){f.drawImage(e,0,0)}}else f.fillStyle="#ffffff",f.fillRect(0,0,l.width,l.height)}),[f,l,t]);var P=function(e){if(!l)throw Error("No canvas");var t=l.getBoundingClientRect(),a=l.width/t.width,n=l.height/t.height;if(e.nativeEvent instanceof MouseEvent){var r=e;return{x:(r.clientX-t.left)*a,y:(r.clientY-t.top)*n}}if(e.nativeEvent instanceof TouchEvent){var c=e;return{x:(c.touches[0].clientX-t.left)*a,y:(c.touches[0].clientY-t.top)*n}}throw console.log(e),new Error("event is not MouseEvent or TouchEvent")},L=function(e){if(l){C(!0);var t=P(e);z(t.x),U(t.y),q(t.x,t.y)}},q=function(e,t){f&&(f.fillStyle=y,f.beginPath(),f.arc(e,t,O/2,0,2*Math.PI),f.fill())},F=function(e){if(I&&f&&l){e.preventDefault(),e.stopPropagation();var t=P(e),a=t.x,n=t.y;f.beginPath(),f.moveTo(T,E),f.lineTo(a,n),f.strokeStyle=y,f.lineWidth=O,f.lineCap="round",f.stroke(),z(a),U(n)}},M=function(e){C(!1)},B=function(){i()};return Object(s.jsxs)(c.a,{show:!0,onHide:B,size:"lg",children:[Object(s.jsx)(c.a.Header,{closeButton:!0,children:Object(s.jsx)(c.a.Title,{children:"Image Editor"})}),Object(s.jsxs)(c.a.Body,{children:[Object(s.jsx)("canvas",{style:{width:"100%"},id:"canvas",width:"512",height:"512",onMouseDown:L,onMouseMove:F,onMouseUp:M,onTouchStart:L,onTouchMove:F,onTouchEnd:M}),Object(s.jsxs)("div",{className:"row",children:[Object(s.jsx)("div",{className:"col-md-6",children:Object(s.jsxs)("div",{className:"form-group",children:[Object(s.jsx)("label",{htmlFor:"brushSize",children:"Brush Size"}),Object(s.jsx)("input",{type:"range",className:"form-control",id:"brushSize",min:"1",max:"100",value:O,onChange:function(e){v(parseFloat(e.target.value))}})]})}),Object(s.jsx)("div",{className:"col-md-6",children:Object(s.jsxs)("div",{className:"form-group",children:[Object(s.jsx)("label",{htmlFor:"brushColor",children:"Brush Color"}),Object(s.jsx)("input",{type:"color",className:"form-control",id:"brushColor",value:y,onChange:function(e){w(e.target.value)}})]})})]})]}),Object(s.jsxs)(c.a.Footer,{children:[Object(s.jsx)("button",{className:"btn btn-primary",onClick:function(){if(l&&f){var e=l.toDataURL("image/png");a(e)}},children:"Save"}),Object(s.jsx)("button",{className:"btn btn-secondary",onClick:B,children:"Cancel"})]})]})}},34:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(20),r=function(e){switch(e){case n.b.Pending:return"fas fa-hourglass-start";case n.b.Processing:return"fas fa-cog fa-spin";case n.b.Completed:return"fas fa-check";case n.b.Saved:return"fas fa-save";default:return""}}},64:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return p}));var n=a(2),r=a(3),c=a.n(r),s=a(4),i=a(7),o=a(1),u=a(8),l=a(32),d=a.n(l),b=a(65),j=a.n(b),f=a(33),h=a(0),p=function(t){var a,r=j.a.parse(window.location.search.substring(1)),l=Object(u.f)(),b=Object(o.useState)({phrases:[],label:"",iterations:100,encoded_image:"",enable_video:!1,enable_zoom:!1,zoom_frequency:10,zoom_scale:.99,zoom_shift_x:0,zoom_shift_y:0}),p=Object(i.a)(b,2),m=p[0],O=p[1],v=Object(o.useState)(null),g=Object(i.a)(v,2),x=g[0],y=g[1],w=Object(o.useState)(1),N=Object(i.a)(w,2),k=N[0],I=N[1],C=function(){var e=Object(s.a)(c.a.mark((function e(a){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.preventDefault(),n=0;case 2:if(!(n<k)){e.next=8;break}return e.next=5,t.api.createImage(m);case 5:n++,e.next=2;break;case 8:l.push("/images");case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=Object(s.a)(c.a.mark((function e(t){var a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.target.files&&t.target.files[0]){e.next=3;break}return e.abrupt("return");case 3:d()(a,(function(e){if(e instanceof HTMLCanvasElement){var t=e.toDataURL("image/jpeg").split(",")[1];O(Object(n.a)(Object(n.a)({},m),{},{encoded_image:t}))}}),{maxWidth:512,maxHeight:512,crop:!0,canvas:!0});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(o.useEffect)((function(){var a=function(){var a=Object(s.a)(c.a.mark((function a(r){var s,i,o,u;return c.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.api.getImage(r);case 2:return s=a.sent,a.next=5,t.api.getImageData(s.data.id,{responseType:"arraybuffer"});case 5:i=a.sent,o=e.from(i.data,"binary"),u=o.toString("base64"),O((function(e){return Object(n.a)(Object(n.a)({},e),{},{label:s.data.label,phrases:s.data.phrases,iterations:s.data.iterations,parent:r,encoded_image:u,enable_video:!!s.data.enable_video,enable_zoom:!!s.data.enable_zoom,zoom_frequency:s.data.zoom_frequency||10,zoom_scale:s.data.zoom_scale||.99,zoom_shift_x:s.data.zoom_shift_x||0,zoom_shift_y:s.data.zoom_shift_y||0})}));case 9:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}();r.parent&&a(r.parent)}),[r.parent,O,t.api]),Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("div",{className:"container",children:Object(h.jsx)("div",{className:"row",children:Object(h.jsx)("div",{className:"col-12",children:Object(h.jsx)("h1",{children:"Create new image"})})})}),Object(h.jsx)("div",{className:"row",children:Object(h.jsx)("div",{className:"col-12",children:Object(h.jsx)("div",{className:"spacer"})})}),Object(h.jsx)("div",{className:"row",children:Object(h.jsx)("div",{className:"offset-lg-3 col-lg-6 col-sm-12",children:Object(h.jsxs)("form",{onSubmit:C,children:[Object(h.jsxs)("div",{className:"form-group",children:[Object(h.jsx)("label",{children:"Phrases"}),Object(h.jsx)("input",{className:"form-control",type:"text",value:null===(a=m.phrases)||void 0===a?void 0:a.join("|"),onChange:function(e){return O(Object(n.a)(Object(n.a)({},m),{},{phrases:e.target.value.split("|")}))},placeholder:"Separate | phrases | like this"})]}),Object(h.jsxs)("div",{className:"form-group",children:[Object(h.jsx)("label",{children:"Label"}),Object(h.jsx)("input",{className:"form-control",type:"text",value:m.label,onChange:function(e){return O(Object(n.a)(Object(n.a)({},m),{},{label:e.target.value}))},placeholder:"Label"})]}),Object(h.jsxs)("div",{className:"form-group",children:[Object(h.jsx)("label",{children:"Iterations"}),Object(h.jsx)("input",{min:1,max:1e4,className:"form-control",type:"number",value:m.iterations,onChange:function(e){return O(Object(n.a)(Object(n.a)({},m),{},{iterations:parseInt(e.target.value)}))}})]}),Object(h.jsxs)("div",{className:"form-group",children:[Object(h.jsx)("label",{children:"Count"}),Object(h.jsx)("input",{className:"form-control",type:"number",max:10,min:1,value:k,onChange:function(e){return I(parseInt(e.target.value))}})]}),Object(h.jsxs)("div",{className:"form-group",children:[Object(h.jsx)("label",{style:{marginRight:"10px"},children:"Enable video"}),Object(h.jsx)("div",{className:"form-check",children:Object(h.jsx)("input",{className:"form-check-input",type:"checkbox",checked:m.enable_video,onChange:function(e){return O(Object(n.a)(Object(n.a)({},m),{},{enable_video:e.target.checked}))}})})]}),m.enable_video&&Object(h.jsxs)("div",{className:"form-group",children:[Object(h.jsx)("label",{style:{marginRight:"10px"},children:"Enable zoom"}),Object(h.jsx)("div",{className:"form-check",children:Object(h.jsx)("input",{className:"form-check-input",type:"checkbox",checked:m.enable_zoom,onChange:function(e){return O(Object(n.a)(Object(n.a)({},m),{},{enable_zoom:e.target.checked}))}})})]}),m.enable_zoom&&Object(h.jsxs)("div",{className:"form-group",children:[Object(h.jsx)("label",{children:"Zoom interval"}),Object(h.jsx)("input",{min:1,max:100,className:"form-control",type:"number",value:m.zoom_frequency,onChange:function(e){return O(Object(n.a)(Object(n.a)({},m),{},{zoom_frequency:parseInt(e.target.value)}))}})]}),m.enable_zoom&&Object(h.jsxs)("div",{className:"form-group",children:[Object(h.jsx)("label",{children:"Zoom scale"}),Object(h.jsx)("input",{min:.1,max:10,step:.01,className:"form-control",type:"number",value:m.zoom_scale,onChange:function(e){return O(Object(n.a)(Object(n.a)({},m),{},{zoom_scale:parseFloat(e.target.value)}))}})]}),m.enable_zoom&&Object(h.jsxs)("div",{className:"form-group",children:[Object(h.jsx)("label",{children:"Zoom shift x"}),Object(h.jsx)("input",{min:-10,max:10,className:"form-control",type:"number",value:m.zoom_shift_x,onChange:function(e){return O(Object(n.a)(Object(n.a)({},m),{},{zoom_shift_x:parseInt(e.target.value)}))}})]}),m.enable_zoom&&Object(h.jsxs)("div",{className:"form-group",children:[Object(h.jsx)("label",{children:"Zoom shift y"}),Object(h.jsx)("input",{min:-10,max:10,className:"form-control",type:"number",value:m.zoom_shift_y,onChange:function(e){return O(Object(n.a)(Object(n.a)({},m),{},{zoom_shift_y:parseInt(e.target.value)}))}})]}),m.encoded_image&&Object(h.jsxs)("div",{className:"form-group",children:[Object(h.jsx)("h5",{children:"Initial Image"}),Object(h.jsx)("img",{alt:"",src:"data:image/jpeg;base64,".concat(m.encoded_image),style:{maxWidth:"100%"}})]}),Object(h.jsxs)("div",{className:"form-group",children:[Object(h.jsxs)("label",{id:"loadimage-wrapper",className:"btn btn-sm btn-primary btn-file",style:{marginTop:"8px",marginRight:"8px"},children:[m.encoded_image?"Replace Image":"Upload Image",Object(h.jsx)("input",{id:"loadimage",type:"file",style:{display:"none"},onChange:function(e){return _(e)}})]}),Object(h.jsx)("button",{type:"button",className:"btn btn-sm btn-primary",onClick:function(){var e=m.encoded_image;if(!e){var t=document.createElement("canvas");t.width=512,t.height=512;var a=t.getContext("2d");a&&(a.fillStyle="white",a.fillRect(0,0,512,512),e=t.toDataURL("image/jpeg").split(",")[1])}e&&y("data:image/jpeg;base64,".concat(e))},children:"Edit Image"})]}),Object(h.jsxs)("div",{className:"form-group",children:[Object(h.jsx)("button",{onClick:function(){l.length>1?l.goBack():l.push("/")},type:"button",className:"btn btn-secondary",children:"Cancel"}),"\xa0",Object(h.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Create"})]})]})})}),x&&Object(h.jsx)(f.a,{encodedImage:"".concat(x),onCancel:function(){return y(null)},onSave:function(e){var t=e.split(",")[1];O(Object(n.a)(Object(n.a)({},m),{},{encoded_image:t})),y(null)}})]})}}).call(this,a(55).Buffer)},67:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return h}));var n=a(3),r=a.n(n),c=a(2),s=a(4),i=a(7),o=a(1),u=a(32),l=a.n(u),d=a(23),b=a(34),j=a(33),f=a(0),h=function(t){var a,n=t.api,u=Object(o.useState)(null),h=Object(i.a)(u,2),p=h[0],m=h[1],O=Object(o.useState)({phrases:[],label:"",iterations:100,encoded_image:"",enable_video:!1}),v=Object(i.a)(O,2),g=v[0],x=v[1],y=Object(o.useState)(Object(d.a)()),w=Object(i.a)(y,2),N=w[0],k=w[1],I=Object(o.useState)(null),C=Object(i.a)(I,2),_=C[0],S=C[1],T=function(){var e=Object(s.a)(r.a.mark((function e(t){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.target.files&&t.target.files[0]){e.next=3;break}return e.abrupt("return");case 3:l()(a,(function(e){if(e instanceof HTMLCanvasElement){var t=e.toDataURL("image/jpeg").split(",")[1];x(Object(c.a)(Object(c.a)({},g),{},{encoded_image:t}))}}),{maxWidth:512,maxHeight:512,crop:!0,canvas:!0});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),z=function(){var e=Object(s.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.createImage(Object(c.a)(Object(c.a)({},g),{},{parent:N||void 0}));case 2:(t=e.sent).data&&(Object(d.b)(t.data.id),k(t.data.id),m(t.data));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(o.useEffect)((function(){var t=function(){var t=Object(s.a)(r.a.mark((function t(a){var s,i,o;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n.getImageData(a,{responseType:"arraybuffer"});case 3:s=t.sent,i=e.from(s.data,"binary"),o=i.toString("base64"),x((function(e){return Object(c.a)(Object(c.a)({},e),{},{encoded_image:o})})),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.error(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}(),a=function(){var e=Object(s.a)(r.a.mark((function e(){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(N){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,n.getImage(N);case 5:a=e.sent,m((function(e){return!a.data||e&&e.updated_at===a.data.updated_at?e:(t(N),x((function(e){return Object(c.a)(Object(c.a)({},e),{},{phrases:a.data.phrases,label:a.data.label,iterations:a.data.iterations,enable_video:a.data.enable_video})})),a.data)})),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(2),console.error(e.t0),k(null),Object(d.b)(null);case 14:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(){return e.apply(this,arguments)}}();a();var i=setInterval(a,2e3);return function(){return clearInterval(i)}}),[N,n]);var D=p&&("pending"===p.status||"processing"===p.status)||!1;return Object(f.jsxs)("div",{className:"container",children:[Object(f.jsx)("div",{className:"row",children:Object(f.jsx)("div",{className:"col-12",children:Object(f.jsx)("h1",{children:"Interactive Designer"})})}),Object(f.jsx)("div",{className:"row",children:Object(f.jsx)("div",{className:"col-12",children:Object(f.jsx)("div",{className:"spacer"})})}),Object(f.jsx)("div",{className:"row",children:Object(f.jsx)("div",{className:"offset-lg-3 col-lg-6 col-sm-12",children:Object(f.jsxs)("form",{onSubmit:function(e){return e.preventDefault()},children:[Object(f.jsxs)("div",{className:"form-group",children:[Object(f.jsx)("label",{children:"Phrases"}),Object(f.jsx)("input",{disabled:D,className:"form-control",type:"text",value:null===(a=g.phrases)||void 0===a?void 0:a.join("|"),onChange:function(e){return x(Object(c.a)(Object(c.a)({},g),{},{phrases:e.target.value.split("|")}))},placeholder:"Separate | phrases | like this"})]}),Object(f.jsxs)("div",{className:"form-group",children:[Object(f.jsx)("label",{children:"Label"}),Object(f.jsx)("input",{disabled:D,className:"form-control",type:"text",value:g.label,onChange:function(e){return x(Object(c.a)(Object(c.a)({},g),{},{label:e.target.value}))},placeholder:"Label"})]}),Object(f.jsxs)("div",{className:"form-group",children:[Object(f.jsx)("label",{children:"Iterations"}),Object(f.jsx)("input",{disabled:D,min:1,max:1e3,className:"form-control",type:"number",value:g.iterations,onChange:function(e){return x(Object(c.a)(Object(c.a)({},g),{},{iterations:parseInt(e.target.value)}))}})]}),Object(f.jsxs)("div",{className:"form-group",children:[Object(f.jsx)("label",{style:{marginRight:"10px"},children:"Enable video"}),Object(f.jsx)("div",{className:"form-check",children:Object(f.jsx)("input",{className:"form-check-input",type:"checkbox",checked:g.enable_video,onChange:function(e){return x(Object(c.a)(Object(c.a)({},g),{},{enable_video:e.target.checked}))}})})]}),g.encoded_image&&Object(f.jsxs)("div",{className:"form-group",children:[Object(f.jsx)("h5",{children:"Image"}),Object(f.jsx)("img",{alt:"",src:"data:image/jpeg;base64,".concat(g.encoded_image),style:{maxWidth:"100%"}})]}),Object(f.jsx)("div",{className:"form-group",children:p&&"processing"===p.status&&Object(f.jsx)("div",{className:"progress",children:Object(f.jsx)("div",{className:"progress-bar",role:"progressbar",style:{width:"".concat(1*p.current_iterations/p.iterations*100,"%")}})})}),Object(f.jsxs)("div",{className:"form-group",children:[Object(f.jsxs)("label",{id:"loadimage-wrapper",className:"btn btn-primary btn-file",style:{marginTop:"8px"},children:[Object(f.jsx)("i",{className:"fas fa-upload"}),Object(f.jsx)("input",{disabled:D,id:"loadimage",type:"file",style:{display:"none"},onChange:function(e){return T(e)}})]}),"\xa0",function(){var e=Object(f.jsx)("button",{type:"button",className:"btn btn-primary",onClick:z,children:Object(f.jsx)("i",{className:"fas fa-play"})});return p&&"completed"!==p.status&&"saved"!==p.status?Object(f.jsxs)("button",{type:"button",className:"btn btn-primary",disabled:!0,children:[Object(f.jsx)("i",{className:Object(b.a)(p.status)}),"\xa0"]}):e}(),"\xa0",Object(f.jsx)("button",{disabled:D,type:"button",className:"btn btn-primary",onClick:function(){var e=g.encoded_image;if(!e){var t=document.createElement("canvas");t.width=512,t.height=512;var a=t.getContext("2d");a&&(a.fillStyle="white",a.fillRect(0,0,512,512),e=t.toDataURL("image/jpeg").split(",")[1])}e&&S("data:image/jpeg;base64,".concat(e))},children:Object(f.jsx)("i",{className:"fas fa-edit"})})]})]})})}),_&&Object(f.jsx)(j.a,{encodedImage:"".concat(_),onCancel:function(){return S(null)},onSave:function(e){var t=e.split(",")[1];x(Object(c.a)(Object(c.a)({},g),{},{encoded_image:t})),S(null)}})]})}}).call(this,a(55).Buffer)},74:function(e,t,a){},95:function(e,t,a){},96:function(e,t,a){}},[[122,1,2]]]);
//# sourceMappingURL=main.3e14ccc2.chunk.js.map