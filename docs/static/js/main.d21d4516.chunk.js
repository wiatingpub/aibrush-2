(this["webpackJsonpaibrush-frontend"]=this["webpackJsonpaibrush-frontend"]||[]).push([[0],{113:function(e,t){},116:function(e,t,a){"use strict";a.r(t);var n,r,c,s=a(1),i=a.n(s),o=a(19),u=a.n(o),l=(a(68),a(2)),d=a.n(l),b=a(4),j=a(7),h=a(10),p=a.n(h),f=a(16),m=a(8),O=(a(89),a(90),a(23)),v=a(54),g=a(27),x=a(30),y=a(3),w=a(29),k=a(62),N="https://aibrush.ngrok.io".replace(/\/+$/,""),I=function e(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:N,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:p.a;Object(O.a)(this,e),this.basePath=a,this.axios=n,this.configuration=void 0,t&&(this.configuration=t,this.basePath=t.basePath||this.basePath)},C=function(e){Object(g.a)(a,e);var t=Object(x.a)(a);function a(e,n){var r;return Object(O.a)(this,a),(r=t.call(this,n)).field=e,r.name="RequiredError",r}return a}(Object(k.a)(Error)),S="https://example.com",P=function(e,t,a){if(null===a||void 0===a)throw new C(t,"Required parameter ".concat(t," was null or undefined when calling ").concat(e,"."))},U=function(e){for(var t=new URLSearchParams(e.search),a=arguments.length,n=new Array(a>1?a-1:0),r=1;r<a;r++)n[r-1]=arguments[r];for(var c=0,s=n;c<s.length;c++){var i=s[c];for(var o in i)if(Array.isArray(i[o])){t.delete(o);var u,l=Object(w.a)(i[o]);try{for(l.s();!(u=l.n()).done;){var d=u.value;t.append(o,d)}}catch(b){l.e(b)}finally{l.f()}}else t.set(o,i[o])}e.search=t.toString()},T=function(e,t,a){var n="string"!==typeof e;return(n&&a&&a.isJsonMime?a.isJsonMime(t.headers["Content-Type"]):n)?JSON.stringify(void 0!==e?e:{}):e||""},R=function(e){return e.pathname+e.search+e.hash},E=function(e,t,a,n){return function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a,s=Object(y.a)(Object(y.a)({},e.options),{},{url:((null===n||void 0===n?void 0:n.basePath)||c)+e.url});return r.request(s)}};!function(e){e.Ok="ok"}(n||(n={})),function(e){e.Pending="pending",e.Processing="processing",e.Completed="completed",e.Saved="saved"}(r||(r={})),function(e){e.Pending="pending",e.Processing="processing",e.Completed="completed",e.Saved="saved"}(c||(c={}));var L=function(e){var t=function(e){return{createImage:function(){var t=Object(b.a)(d.a.mark((function t(a){var n,r,c,s,i,o,u,l=arguments;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=l.length>1&&void 0!==l[1]?l[1]:{},r=new URL("/images",S),e&&(c=e.baseOptions),s=Object(y.a)(Object(y.a)({method:"POST"},c),n),o={},(i={})["Content-Type"]="application/json",U(r,o,n.query),u=c&&c.headers?c.headers:{},s.headers=Object(y.a)(Object(y.a)(Object(y.a)({},i),u),n.headers),s.data=T(a,s,e),t.abrupt("return",{url:R(r),options:s});case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),deleteImage:function(){var t=Object(b.a)(d.a.mark((function t(a){var n,r,c,s,i,o,u,l=arguments;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=l.length>1&&void 0!==l[1]?l[1]:{},P("deleteImage","id",a),r="/images/{id}".replace("{".concat("id","}"),encodeURIComponent(String(a))),c=new URL(r,S),e&&(s=e.baseOptions),i=Object(y.a)(Object(y.a)({method:"DELETE"},s),n),o={},U(c,{},n.query),u=s&&s.headers?s.headers:{},i.headers=Object(y.a)(Object(y.a)(Object(y.a)({},o),u),n.headers),t.abrupt("return",{url:R(c),options:i});case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),getImage:function(){var t=Object(b.a)(d.a.mark((function t(a,n){var r,c,s,i,o,u,l,b,j=arguments;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=j.length>2&&void 0!==j[2]?j[2]:{},P("getImage","id",a),c="/images/{id}".replace("{".concat("id","}"),encodeURIComponent(String(a))),s=new URL(c,S),e&&(i=e.baseOptions),o=Object(y.a)(Object(y.a)({method:"GET"},i),r),u={},l={},void 0!==n&&(l.download=n),U(s,l,r.query),b=i&&i.headers?i.headers:{},o.headers=Object(y.a)(Object(y.a)(Object(y.a)({},u),b),r.headers),t.abrupt("return",{url:R(s),options:o});case 13:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),getImageData:function(){var t=Object(b.a)(d.a.mark((function t(a){var n,r,c,s,i,o,u,l=arguments;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=l.length>1&&void 0!==l[1]?l[1]:{},P("getImageData","id",a),r="/images/{id}/image.jpg".replace("{".concat("id","}"),encodeURIComponent(String(a))),c=new URL(r,S),e&&(s=e.baseOptions),i=Object(y.a)(Object(y.a)({method:"GET"},s),n),o={},U(c,{},n.query),u=s&&s.headers?s.headers:{},i.headers=Object(y.a)(Object(y.a)(Object(y.a)({},o),u),n.headers),t.abrupt("return",{url:R(c),options:i});case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),getThumbnailData:function(){var t=Object(b.a)(d.a.mark((function t(a){var n,r,c,s,i,o,u,l=arguments;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=l.length>1&&void 0!==l[1]?l[1]:{},P("getThumbnailData","id",a),r="/images/{id}/thumbnail.jpg".replace("{".concat("id","}"),encodeURIComponent(String(a))),c=new URL(r,S),e&&(s=e.baseOptions),i=Object(y.a)(Object(y.a)({method:"GET"},s),n),o={},U(c,{},n.query),u=s&&s.headers?s.headers:{},i.headers=Object(y.a)(Object(y.a)(Object(y.a)({},o),u),n.headers),t.abrupt("return",{url:R(c),options:i});case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),healthcheck:function(){var t=Object(b.a)(d.a.mark((function t(){var a,n,r,c,s,i,o=arguments;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=o.length>0&&void 0!==o[0]?o[0]:{},n=new URL("/healthcheck",S),e&&(r=e.baseOptions),c=Object(y.a)(Object(y.a)({method:"GET"},r),a),s={},U(n,{},a.query),i=r&&r.headers?r.headers:{},c.headers=Object(y.a)(Object(y.a)(Object(y.a)({},s),i),a.headers),t.abrupt("return",{url:R(n),options:c});case 11:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),listImages:function(){var t=Object(b.a)(d.a.mark((function t(a){var n,r,c,s,i,o,u,l=arguments;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=l.length>1&&void 0!==l[1]?l[1]:{},r=new URL("/images",S),e&&(c=e.baseOptions),s=Object(y.a)(Object(y.a)({method:"GET"},c),n),i={},o={},void 0!==a&&(o.cursor=a),U(r,o,n.query),u=c&&c.headers?c.headers:{},s.headers=Object(y.a)(Object(y.a)(Object(y.a)({},i),u),n.headers),t.abrupt("return",{url:R(r),options:s});case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),login:function(){var t=Object(b.a)(d.a.mark((function t(a){var n,r,c,s,i,o,u,l=arguments;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=l.length>1&&void 0!==l[1]?l[1]:{},r=new URL("/auth/login",S),e&&(c=e.baseOptions),s=Object(y.a)(Object(y.a)({method:"POST"},c),n),o={},(i={})["Content-Type"]="application/json",U(r,o,n.query),u=c&&c.headers?c.headers:{},s.headers=Object(y.a)(Object(y.a)(Object(y.a)({},i),u),n.headers),s.data=T(a,s,e),t.abrupt("return",{url:R(r),options:s});case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),processImage:function(){var t=Object(b.a)(d.a.mark((function t(){var a,n,r,c,s,i,o=arguments;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=o.length>0&&void 0!==o[0]?o[0]:{},n=new URL("/process-image",S),e&&(r=e.baseOptions),c=Object(y.a)(Object(y.a)({method:"PUT"},r),a),s={},U(n,{},a.query),i=r&&r.headers?r.headers:{},c.headers=Object(y.a)(Object(y.a)(Object(y.a)({},s),i),a.headers),t.abrupt("return",{url:R(n),options:c});case 11:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),refresh:function(){var t=Object(b.a)(d.a.mark((function t(a){var n,r,c,s,i,o,u,l=arguments;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=l.length>1&&void 0!==l[1]?l[1]:{},r=new URL("/auth/refresh",S),e&&(c=e.baseOptions),s=Object(y.a)(Object(y.a)({method:"POST"},c),n),o={},(i={})["Content-Type"]="application/json",U(r,o,n.query),u=c&&c.headers?c.headers:{},s.headers=Object(y.a)(Object(y.a)(Object(y.a)({},i),u),n.headers),s.data=T(a,s,e),t.abrupt("return",{url:R(r),options:s});case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),updateImage:function(){var t=Object(b.a)(d.a.mark((function t(a,n){var r,c,s,i,o,u,l,b,j=arguments;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=j.length>2&&void 0!==j[2]?j[2]:{},P("updateImage","id",a),c="/images/{id}".replace("{".concat("id","}"),encodeURIComponent(String(a))),s=new URL(c,S),e&&(i=e.baseOptions),o=Object(y.a)(Object(y.a)({method:"PATCH"},i),r),l={},(u={})["Content-Type"]="application/json",U(s,l,r.query),b=i&&i.headers?i.headers:{},o.headers=Object(y.a)(Object(y.a)(Object(y.a)({},u),b),r.headers),o.data=T(n,o,e),t.abrupt("return",{url:R(s),options:o});case 14:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),verify:function(){var t=Object(b.a)(d.a.mark((function t(a){var n,r,c,s,i,o,u,l=arguments;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=l.length>1&&void 0!==l[1]?l[1]:{},r=new URL("/auth/verify",S),e&&(c=e.baseOptions),s=Object(y.a)(Object(y.a)({method:"POST"},c),n),o={},(i={})["Content-Type"]="application/json",U(r,o,n.query),u=c&&c.headers?c.headers:{},s.headers=Object(y.a)(Object(y.a)(Object(y.a)({},i),u),n.headers),s.data=T(a,s,e),t.abrupt("return",{url:R(r),options:s});case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}(e);return{createImage:function(a,n){return Object(b.a)(d.a.mark((function r(){var c;return d.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.createImage(a,n);case 2:return c=r.sent,r.abrupt("return",E(c,p.a,N,e));case 4:case"end":return r.stop()}}),r)})))()},deleteImage:function(a,n){return Object(b.a)(d.a.mark((function r(){var c;return d.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.deleteImage(a,n);case 2:return c=r.sent,r.abrupt("return",E(c,p.a,N,e));case 4:case"end":return r.stop()}}),r)})))()},getImage:function(a,n,r){return Object(b.a)(d.a.mark((function c(){var s;return d.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,t.getImage(a,n,r);case 2:return s=c.sent,c.abrupt("return",E(s,p.a,N,e));case 4:case"end":return c.stop()}}),c)})))()},getImageData:function(a,n){return Object(b.a)(d.a.mark((function r(){var c;return d.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.getImageData(a,n);case 2:return c=r.sent,r.abrupt("return",E(c,p.a,N,e));case 4:case"end":return r.stop()}}),r)})))()},getThumbnailData:function(a,n){return Object(b.a)(d.a.mark((function r(){var c;return d.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.getThumbnailData(a,n);case 2:return c=r.sent,r.abrupt("return",E(c,p.a,N,e));case 4:case"end":return r.stop()}}),r)})))()},healthcheck:function(a){return Object(b.a)(d.a.mark((function n(){var r;return d.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.healthcheck(a);case 2:return r=n.sent,n.abrupt("return",E(r,p.a,N,e));case 4:case"end":return n.stop()}}),n)})))()},listImages:function(a,n){return Object(b.a)(d.a.mark((function r(){var c;return d.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.listImages(a,n);case 2:return c=r.sent,r.abrupt("return",E(c,p.a,N,e));case 4:case"end":return r.stop()}}),r)})))()},login:function(a,n){return Object(b.a)(d.a.mark((function r(){var c;return d.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.login(a,n);case 2:return c=r.sent,r.abrupt("return",E(c,p.a,N,e));case 4:case"end":return r.stop()}}),r)})))()},processImage:function(a){return Object(b.a)(d.a.mark((function n(){var r;return d.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.processImage(a);case 2:return r=n.sent,n.abrupt("return",E(r,p.a,N,e));case 4:case"end":return n.stop()}}),n)})))()},refresh:function(a,n){return Object(b.a)(d.a.mark((function r(){var c;return d.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.refresh(a,n);case 2:return c=r.sent,r.abrupt("return",E(c,p.a,N,e));case 4:case"end":return r.stop()}}),r)})))()},updateImage:function(a,n,r){return Object(b.a)(d.a.mark((function c(){var s;return d.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,t.updateImage(a,n,r);case 2:return s=c.sent,c.abrupt("return",E(s,p.a,N,e));case 4:case"end":return c.stop()}}),c)})))()},verify:function(a,n){return Object(b.a)(d.a.mark((function r(){var c;return d.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.verify(a,n);case 2:return c=r.sent,r.abrupt("return",E(c,p.a,N,e));case 4:case"end":return r.stop()}}),r)})))()}}},D=function(e){Object(g.a)(a,e);var t=Object(x.a)(a);function a(){return Object(O.a)(this,a),t.apply(this,arguments)}return Object(v.a)(a,[{key:"createImage",value:function(e,t){var a=this;return L(this.configuration).createImage(e,t).then((function(e){return e(a.axios,a.basePath)}))}},{key:"deleteImage",value:function(e,t){var a=this;return L(this.configuration).deleteImage(e,t).then((function(e){return e(a.axios,a.basePath)}))}},{key:"getImage",value:function(e,t,a){var n=this;return L(this.configuration).getImage(e,t,a).then((function(e){return e(n.axios,n.basePath)}))}},{key:"getImageData",value:function(e,t){var a=this;return L(this.configuration).getImageData(e,t).then((function(e){return e(a.axios,a.basePath)}))}},{key:"getThumbnailData",value:function(e,t){var a=this;return L(this.configuration).getThumbnailData(e,t).then((function(e){return e(a.axios,a.basePath)}))}},{key:"healthcheck",value:function(e){var t=this;return L(this.configuration).healthcheck(e).then((function(e){return e(t.axios,t.basePath)}))}},{key:"listImages",value:function(e,t){var a=this;return L(this.configuration).listImages(e,t).then((function(e){return e(a.axios,a.basePath)}))}},{key:"login",value:function(e,t){var a=this;return L(this.configuration).login(e,t).then((function(e){return e(a.axios,a.basePath)}))}},{key:"processImage",value:function(e){var t=this;return L(this.configuration).processImage(e).then((function(e){return e(t.axios,t.basePath)}))}},{key:"refresh",value:function(e,t){var a=this;return L(this.configuration).refresh(e,t).then((function(e){return e(a.axios,a.basePath)}))}},{key:"updateImage",value:function(e,t,a){var n=this;return L(this.configuration).updateImage(e,t,a).then((function(e){return e(n.axios,n.basePath)}))}},{key:"verify",value:function(e,t){var a=this;return L(this.configuration).verify(e,t).then((function(e){return e(a.axios,a.basePath)}))}}]),a}(I);var B=a(0),F=function(e){var t=Object(s.useState)(""),a=Object(j.a)(t,2),n=a[0],r=a[1],c=Object(s.useState)(!1),i=Object(j.a)(c,2),o=i[0],u=i[1],l=Object(s.useState)(""),h=Object(j.a)(l,2),p=h[0],f=h[1],m=Object(s.useState)(""),O=Object(j.a)(m,2),v=O[0],g=O[1],x=function(){var t=Object(b.a)(d.a.mark((function t(){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(g(""),n.match(/^[^@]+@[^@]+\.[^@]+$/)){t.next=4;break}return g("Invalid email address"),t.abrupt("return");case 4:return t.next=6,e.client.login({email:n});case 6:u(!0);case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),y=function(){var t=Object(b.a)(d.a.mark((function t(){var a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return g(""),t.prev=1,t.next=4,e.client.verify({email:n,code:p});case 4:a=t.sent,e.onLogin(a.data),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(1),console.error(t.t0),g("Failed to verify code");case 12:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(){return t.apply(this,arguments)}}();return Object(B.jsx)("div",{className:"container",children:Object(B.jsx)("div",{className:"row",children:Object(B.jsx)("div",{className:"col-md-6 offset-md-3",children:Object(B.jsx)("div",{className:"card",children:Object(B.jsxs)("div",{className:"card-body",children:[Object(B.jsx)("h5",{className:"card-title",children:"Login"}),v&&Object(B.jsx)("p",{className:"text-danger",children:v}),o&&Object(B.jsxs)("div",{children:[Object(B.jsxs)("div",{className:"form-group",children:[Object(B.jsx)("label",{htmlFor:"verifyCode",children:"Verify Code"}),Object(B.jsx)("input",{type:"text",className:"form-control",id:"verifyCode",placeholder:"Verification Code",value:p,onChange:function(e){return f(e.target.value)}})]}),Object(B.jsx)("button",{className:"btn btn-secondary",onClick:function(){return u(!1)},children:"Cancel"}),"\xa0",Object(B.jsx)("button",{type:"button",className:"btn btn-primary",onClick:function(e){e.preventDefault(),y()},children:"Verify"})]}),!o&&Object(B.jsxs)("div",{children:[Object(B.jsxs)("div",{className:"form-group",children:[Object(B.jsx)("label",{htmlFor:"email",children:"Email address"}),Object(B.jsx)("input",{type:"email",className:"form-control",id:"email","aria-describedby":"emailHelp",placeholder:"Enter email",value:n,onChange:function(e){return r(e.target.value)}}),Object(B.jsx)("small",{id:"emailHelp",className:"form-text text-muted",children:"We'll never share your email with anyone else."})]}),Object(B.jsx)("button",{type:"button",className:"btn btn-primary",onClick:function(e){e.preventDefault(),x()},children:"Login"})]})]})})})})})},q=function(){return Object(B.jsxs)("div",{className:"container",children:[Object(B.jsx)("div",{className:"row",children:Object(B.jsx)("div",{className:"col-12",children:Object(B.jsx)("h1",{children:"Welcome to AIBrush!"})})}),Object(B.jsx)("div",{className:"row",children:Object(B.jsx)("div",{className:"col-12",children:Object(B.jsx)("div",{className:"spacer"})})}),Object(B.jsx)("div",{className:"row",children:Object(B.jsx)("div",{className:"col-sm-12",children:Object(B.jsxs)("div",{className:"btn-group-vertical",children:[Object(B.jsxs)(f.b,{to:"/create-image",className:"btn btn-primary",children:[Object(B.jsx)("i",{className:"fas fa-image"}),"\xa0 Create a new image"]}),Object(B.jsxs)(f.b,{to:"/images",className:"btn btn-primary",children:[Object(B.jsx)("i",{className:"fas fa-folder-open"}),"\xa0 My Images"]}),Object(B.jsxs)(f.b,{to:"/workspace",className:"btn btn-primary",children:[Object(B.jsx)("i",{className:"fas fa-th"}),"\xa0 Workspace"]})]})})})]})},_=a(57),H=a(20),J=function(e){switch(e){case r.Pending:return"fas fa-hourglass-start";case r.Processing:return"fas fa-cog fa-spin";case r.Completed:return"fas fa-check";case r.Saved:return"fas fa-save";default:return""}},M=function(e){var t=e.apiUrl,a=e.image,n=e.onClick,r=e.onDelete,c=e.onSave,i=e.onFork,o="".concat(t,"/images/").concat(a.id,"/thumbnail.jpg?updated_at=").concat(a.updated_at);return Object(s.useEffect)((function(){var e=document.getElementById("image-".concat(a.id));e.onerror=function(){e.src="/images/default.jpg"}})),Object(B.jsxs)("div",{className:"card",style:{padding:"10px",width:"200px",margin:"10px"},children:[Object(B.jsx)("img",{style:{cursor:"pointer"},id:"image-".concat(a.id),className:"card-img-top",src:o,alt:a.label,onClick:function(){return n(a)}}),Object(B.jsxs)("div",{className:"card-body",children:[Object(B.jsxs)("div",{children:[Object(B.jsx)("h5",{className:"card-title",children:a.label}),Object(B.jsxs)("p",{className:"card-text",children:[Object(B.jsx)("i",{className:J(a.status)}),"\xa0",a.status]}),"processing"===a.status&&Object(B.jsx)("div",{className:"progress",children:Object(B.jsx)("div",{className:"progress-bar",role:"progressbar",style:{width:"".concat(1*a.current_iterations/a.iterations*100,"%")}})})]}),Object(B.jsx)("hr",{}),c&&"completed"==a.status&&Object(B.jsx)("button",{className:"btn btn-primary btn-sm",onClick:function(){return c(a)},style:{marginRight:"5px"},children:Object(B.jsx)("i",{className:"fas fa-save"})}),r&&Object(B.jsx)("button",{className:"btn btn-danger btn-sm",onClick:function(){return r&&r(a)},style:{marginRight:"5px"},children:Object(B.jsx)("i",{className:"fas fa-trash-alt"})}),i&&"saved"==a.status&&Object(B.jsx)("button",{className:"btn btn-secondary btn-sm",onClick:function(){return i&&i(a)},style:{marginRight:"5px"},children:Object(B.jsx)("i",{className:"fas fa-code-branch"})})]})]})},A=a(21),W=a(25),z=function(e){var t=e.apiUrl,a=e.image,n=e.onClose,r="".concat(t,"/images/").concat(a.id,"/image.jpg?updated_at=").concat(a.updated_at);return Object(s.useEffect)((function(){var e=document.getElementById("image-popup-".concat(a.id));e.onerror=function(){e.src="/images/default.jpg"}})),Object(B.jsxs)(W.a,{show:!0,onHide:n,size:"lg",children:[Object(B.jsx)(W.a.Header,{closeButton:!0,children:Object(B.jsx)(W.a.Title,{children:a.label})}),Object(B.jsxs)(W.a.Body,{children:[Object(B.jsx)("img",{style:{width:"100%"},id:"image-popup-".concat(a.id),src:r,alt:a.label}),Object(B.jsxs)("div",{children:[Object(B.jsxs)("p",{children:["Status: ",a.status]}),Object(B.jsxs)("p",{children:["Iterations: ",a.iterations]}),Object(B.jsxs)("p",{children:["Current iterations: ",a.current_iterations]}),Object(B.jsxs)("p",{children:["Score: ",a.score]}),Object(B.jsxs)("p",{children:["Phrases: ",a.phrases.join(", ")]})]})]})]})},G=function(e){var t,a=e.apiUrl,n=e.api,i=Object(s.useState)({images:[]}),o=Object(j.a)(i,2),u=o[0],l=o[1],h=Object(s.useState)(""),p=Object(j.a)(h,2),O=p[0],v=p[1],g=Object(s.useState)(),x=Object(j.a)(g,2),k=x[0],N=x[1],I=Object(m.f)(),C=Object(s.useState)((t={},Object(H.a)(t,r.Pending,!0),Object(H.a)(t,r.Processing,!0),Object(H.a)(t,r.Completed,!0),Object(H.a)(t,r.Saved,!0),t)),S=Object(j.a)(C,2),P=S[0],U=S[1],T=function(e,t){U(Object(y.a)(Object(y.a)({},P),{},Object(H.a)({},e,t)))},R=function(){var e=Object(b.a)(d.a.mark((function e(t){var a,r,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.updateImage(t.id,{status:c.Saved});case 3:a=e.sent,r=a.data,s={images:u.images.map((function(e){return e.id===r.id?r:e}))},l(s),Object(A.b)(s),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0),v("Could not save image");case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}();Object(s.useEffect)((function(){var e=Object(A.a)();l(e);var t=!1,a=setInterval(Object(b.a)(d.a.mark((function a(){var r,c,s,i,o,u;return d.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!t){a.next=2;break}return a.abrupt("return");case 2:a.prev=2,t=!0,r=[],c=Object(w.a)(e.images),a.prev=6,c.s();case 8:if((s=c.n()).done){a.next=24;break}return i=s.value,a.prev=10,a.next=13,n.getImage(i.id);case 13:o=a.sent,u=o.data,r.push(u),k&&u.id==k.id&&N(u),a.next=22;break;case 19:a.prev=19,a.t0=a.catch(10),console.error(a.t0);case 22:a.next=8;break;case 24:a.next=29;break;case 26:a.prev=26,a.t1=a.catch(6),c.e(a.t1);case 29:return a.prev=29,c.f(),a.finish(29);case 32:l(e={images:r}),Object(A.b)(e);case 35:return a.prev=35,t=!1,a.finish(35);case 38:case"end":return a.stop()}}),a,null,[[2,,35,38],[6,26,29,32],[10,19]])}))),5e3);return function(){clearInterval(a)}}),[u&&u.images.length]);var E=function(){var e=Object(b.a)(d.a.mark((function e(t){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return v(""),e.prev=1,a=Object(y.a)(Object(y.a)({},u),{},{images:u.images.filter((function(e){return e.id!==t.id}))}),l(a),Object(A.b)(a),e.next=7,n.deleteImage(t.id);case 7:e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),console.error(e.t0),v("Could not delete image");case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),L=function(){var e=Object(b.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:I.push("/create-image?parent=".concat(t.id));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),D=function(e){N(e)};return Object(B.jsxs)("div",{className:"container",children:[Object(B.jsx)("div",{className:"row",children:Object(B.jsx)("div",{className:"col-12",children:Object(B.jsx)("h1",{children:"Workspace"})})}),O&&Object(B.jsx)("div",{className:"row",children:Object(B.jsx)("div",{className:"col-12",children:Object(B.jsx)("div",{className:"alert alert-danger",role:"alert",children:O})})}),Object(B.jsx)("hr",{}),Object(B.jsx)("div",{className:"row",children:Object(B.jsx)("div",{className:"col-12",children:Object(B.jsxs)(f.b,{to:"/create-image",className:"btn btn-primary",children:[Object(B.jsx)("i",{className:"fas fa-plus"}),"\xa0 Create Image"]})})}),Object(B.jsx)("hr",{}),Object(B.jsx)("div",{className:"row",children:Object(B.jsxs)("div",{className:"col-12",children:[Object(B.jsxs)("div",{className:"form-check",children:[Object(B.jsx)("input",{className:"form-check-input",type:"checkbox",checked:P[r.Pending],onChange:function(e){return T(r.Pending,e.target.checked)}}),Object(B.jsx)("label",{className:"form-check-label",children:"Pending"})]}),Object(B.jsxs)("div",{className:"form-check",children:[Object(B.jsx)("input",{className:"form-check-input",type:"checkbox",checked:P[r.Processing],onChange:function(e){return T(r.Processing,e.target.checked)}}),Object(B.jsx)("label",{className:"form-check-label",children:"Processing"})]}),Object(B.jsxs)("div",{className:"form-check",children:[Object(B.jsx)("input",{className:"form-check-input",type:"checkbox",checked:P[r.Completed],onChange:function(e){return T(r.Completed,e.target.checked)}}),Object(B.jsx)("label",{className:"form-check-label",children:"Completed"})]}),Object(B.jsxs)("div",{className:"form-check",children:[Object(B.jsx)("input",{className:"form-check-input",type:"checkbox",checked:P[r.Saved],onChange:function(e){return T(r.Saved,e.target.checked)}}),Object(B.jsx)("label",{className:"form-check-label",children:"Saved"})]})]})}),Object(B.jsx)("hr",{}),Object(B.jsx)("div",{className:"row",children:Object(B.jsx)("div",{className:"col-12",children:Object(B.jsx)("div",{className:"spacer"})})}),Object(B.jsx)("div",{className:"row",children:Object(B.jsx)("div",{className:"col-12",children:Object(B.jsx)("div",{className:"row",children:u.images.filter((function(e){return P[e.status]})).map((function(e){return Object(B.jsx)(M,{onFork:L,onSave:R,apiUrl:a,image:e,onClick:D,onDelete:E},"image-thumbnail-".concat(e.id))}))})})}),k&&Object(B.jsx)(z,{apiUrl:a,image:k,onClose:function(){return N(void 0)}})]})},V=function(e){var t=e.api,a=e.apiUrl,n=Object(m.f)(),r=Object(s.useState)([]),c=Object(j.a)(r,2),i=c[0],o=c[1],u=Object(s.useState)(!0),l=Object(j.a)(u,2),h=l[0],p=l[1],f=Object(s.useState)(null),O=Object(j.a)(f,2),v=O[0],g=O[1],x=Object(s.useState)(null),y=Object(j.a)(x,2),w=(y[0],y[1]),k=function(){var e=Object(b.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.push("/create-image?parent=".concat(t.id));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(s.useEffect)((function(){t.listImages().then((function(e){e.data.images&&o(e.data.images),p(!1)})).catch((function(e){g(e.message),p(!1)}))}),[t]),h?Object(B.jsx)("div",{children:"Loading..."}):v?Object(B.jsxs)("div",{children:["Error: ",v]}):Object(B.jsxs)("div",{className:"container",children:[Object(B.jsx)("div",{className:"row",children:Object(B.jsx)("div",{className:"col-md-12",children:Object(B.jsx)("h1",{children:"Images"})})}),Object(B.jsx)("div",{className:"row",children:Object(B.jsx)("div",{className:"col-md-12",children:Object(B.jsx)("div",{className:"row",children:i.map((function(e){return Object(B.jsx)(M,{onFork:k,onClick:w,apiUrl:a,image:e},e.id)}))})})})]})},$=function(e){var t=e.onCredentialsRefreshed,a=e.api,n=e.credentials;return Object(s.useEffect)((function(){var e=setInterval((function(){n&&n.refreshToken&&a.refresh({refreshToken:n.refreshToken}).then((function(e){t(e.data)}))}),3e5);return function(){clearInterval(e)}}),[n&&n.refreshToken]),Object(B.jsx)("div",{})},X=function(e){var t=e.api,a=Object(s.useState)(!0),n=Object(j.a)(a,2),r=n[0],c=n[1];return Object(s.useEffect)((function(){var e=setInterval((function(){t.healthcheck().then((function(){return c(!0)})).catch((function(){return c(!1)}))}),5e3);return function(){return clearInterval(e)}}),[t]),Object(B.jsx)("div",{className:"alert alert-danger",role:"alert",style:{display:r?"none":"block"},children:Object(B.jsx)("strong",{children:"Service is unavailable"})})},Y={apiUrl:"https://aibrush.ngrok.io"},K=p.a,Q=new D(void 0,localStorage.getItem("apiUrl")||Y.apiUrl,K);function Z(e){e.accessToken&&(K.defaults.headers.common.Authorization="Bearer ".concat(e.accessToken))}var ee=function(){var e=Object(s.useState)(null),t=Object(j.a)(e,2),a=t[0],n=t[1],r=function(){var e=Object(b.a)(d.a.mark((function e(){var t,a,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("App.init"),!(t=localStorage.getItem("credentials"))){e.next=16;break}return e.prev=3,a=JSON.parse(t),e.next=7,Q.refresh({refreshToken:a.refreshToken});case 7:r=e.sent,n(r.data),localStorage.setItem("credentials",JSON.stringify(r.data)),Z(r.data),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[3,13]])})));return function(){return e.apply(this,arguments)}}(),c=function(){var e=Object(b.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:localStorage.setItem("credentials",JSON.stringify(t)),n(t),Z(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(s.useEffect)((function(){r()}),[]),Object(B.jsxs)("div",{className:"App",children:[Object(B.jsx)($,{api:Q,credentials:a,onCredentialsRefreshed:c}),Object(B.jsx)(X,{api:Q}),Object(B.jsxs)("button",{className:"btn btn-primary top-button",onClick:function(){var e=localStorage.getItem("apiUrl")||Y.apiUrl,t=prompt("Configure backend url",e);t&&(e=t,localStorage.setItem("apiUrl",e),window.location.reload())},children:[Object(B.jsx)("i",{className:"fas fa-cog"}),"\xa0 Settings"]}),Object(B.jsxs)(f.a,{children:[!a&&Object(B.jsx)(F,{httpClient:K,client:Q,onLogin:c}),a&&Object(B.jsxs)(B.Fragment,{children:[Object(B.jsxs)("button",{className:"btn btn-primary top-button",onClick:function(){return n(null)},children:[Object(B.jsx)("i",{className:"fas fa-sign-out-alt"}),"\xa0 Logout"]}),Object(B.jsxs)(f.b,{className:"btn btn-primary top-button",to:"/",children:[Object(B.jsx)("i",{className:"fas fa-home"}),"\xa0 Home"]})]}),a&&Object(B.jsxs)(m.c,{children:[Object(B.jsx)(m.a,{path:"/",exact:!0,children:Object(B.jsx)(q,{})}),Object(B.jsx)(m.a,{path:"/create-image",children:Object(B.jsx)(_.a,{api:Q,apiUrl:Y.apiUrl})}),Object(B.jsx)(m.a,{path:"/workspace",children:Object(B.jsx)(G,{apiUrl:Y.apiUrl,api:Q})}),Object(B.jsx)(m.a,{path:"/images",children:Object(B.jsx)(V,{apiUrl:Y.apiUrl,api:Q})})]})]})]})},te=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,118)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,c=t.getLCP,s=t.getTTFB;a(e),n(e),r(e),c(e),s(e)}))};u.a.render(Object(B.jsx)(i.a.StrictMode,{children:Object(B.jsx)(ee,{})}),document.getElementById("root")),te()},21:function(e,t,a){"use strict";function n(){var e=localStorage.getItem("workspace");return e?JSON.parse(e):{images:[]}}function r(e){localStorage.setItem("workspace",JSON.stringify(e))}a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return r}))},57:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return m}));var n=a(3),r=a(2),c=a.n(r),s=a(4),i=a(7),o=a(1),u=a(8),l=a(21),d=a(58),b=a.n(d),j=a(59),h=a.n(j),p=a(60),f=a(0),m=function(t){var a,r=h.a.parse(window.location.search.substring(1)),d=Object(u.f)(),j=Object(o.useState)({phrases:[],label:"",iterations:100,encoded_image:""}),m=Object(i.a)(j,2),O=m[0],v=m[1],g=Object(o.useState)(null),x=Object(i.a)(g,2),y=x[0],w=x[1],k=Object(o.useState)(1),N=Object(i.a)(k,2),I=N[0],C=N[1],S=function(){var e=Object(s.a)(c.a.mark((function e(a){var n,r,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.preventDefault(),n=Object(l.a)(),r=0;case 3:if(!(r<I)){e.next=11;break}return e.next=6,t.api.createImage(O);case 6:s=e.sent,n.images.push(s.data);case 8:r++,e.next=3;break;case 11:Object(l.b)(n),d.push("/workspace");case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),P=function(){var e=Object(s.a)(c.a.mark((function e(t){var a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.target.files&&t.target.files[0]){e.next=3;break}return e.abrupt("return");case 3:b()(a,(function(e){if(e instanceof HTMLCanvasElement){var t=e.toDataURL("image/jpeg").split(",")[1];v(Object(n.a)(Object(n.a)({},O),{},{encoded_image:t}))}}),{maxWidth:512,maxHeight:512,crop:!0,canvas:!0});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),U=function(){var a=Object(s.a)(c.a.mark((function a(r){var s,i,o,u;return c.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.api.getImage(r);case 2:return s=a.sent,a.next=5,t.api.getImageData(s.data.id,{responseType:"arraybuffer"});case 5:i=a.sent,o=e.from(i.data,"binary"),u=o.toString("base64"),v(Object(n.a)(Object(n.a)({},O),{},{label:s.data.label,phrases:s.data.phrases,iterations:s.data.iterations,parent:r,encoded_image:u}));case 9:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}();return Object(o.useEffect)((function(){r.parent&&U(r.parent)}),[r.parent]),Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("div",{className:"container",children:Object(f.jsx)("div",{className:"row",children:Object(f.jsx)("div",{className:"col-12",children:Object(f.jsx)("h1",{children:"Create new image"})})})}),Object(f.jsx)("div",{className:"row",children:Object(f.jsx)("div",{className:"col-12",children:Object(f.jsx)("div",{className:"spacer"})})}),Object(f.jsx)("div",{className:"row",children:Object(f.jsx)("div",{className:"offset-lg-3 col-lg-6 col-sm-12",children:Object(f.jsxs)("form",{onSubmit:S,children:[Object(f.jsxs)("div",{className:"form-group",children:[Object(f.jsx)("label",{children:"Phrases"}),Object(f.jsx)("input",{className:"form-control",type:"text",value:null===(a=O.phrases)||void 0===a?void 0:a.join("|"),onChange:function(e){return v(Object(n.a)(Object(n.a)({},O),{},{phrases:e.target.value.split("|")}))},placeholder:"Separate | phrases | like this"})]}),Object(f.jsxs)("div",{className:"form-group",children:[Object(f.jsx)("label",{children:"Label"}),Object(f.jsx)("input",{className:"form-control",type:"text",value:O.label,onChange:function(e){return v(Object(n.a)(Object(n.a)({},O),{},{label:e.target.value}))},placeholder:"Label"})]}),Object(f.jsxs)("div",{className:"form-group",children:[Object(f.jsx)("label",{children:"Iterations"}),Object(f.jsx)("input",{className:"form-control",type:"number",value:O.iterations,onChange:function(e){return v(Object(n.a)(Object(n.a)({},O),{},{iterations:parseInt(e.target.value)}))}})]}),Object(f.jsxs)("div",{className:"form-group",children:[Object(f.jsx)("label",{children:"Count"}),Object(f.jsx)("input",{className:"form-control",type:"number",max:10,min:1,value:I,onChange:function(e){return C(parseInt(e.target.value))}})]}),O.encoded_image&&Object(f.jsxs)("div",{className:"form-group",children:[Object(f.jsx)("h5",{children:"Initial Image"}),Object(f.jsx)("img",{src:"data:image/jpeg;base64,".concat(O.encoded_image),style:{maxWidth:"100%"}})]}),Object(f.jsxs)("div",{className:"form-group",children:[Object(f.jsxs)("label",{id:"loadimage-wrapper",className:"btn btn-sm btn-primary btn-file",style:{marginTop:"8px",marginRight:"8px"},children:[O.encoded_image?"Replace Image":"Upload Image",Object(f.jsx)("input",{id:"loadimage",type:"file",style:{display:"none"},onChange:function(e){return P(e)}})]}),Object(f.jsx)("button",{type:"button",className:"btn btn-sm btn-primary",onClick:function(){var e=O.encoded_image;if(!e){var t=document.createElement("canvas");t.width=512,t.height=512;var a=t.getContext("2d");a&&(a.fillStyle="white",a.fillRect(0,0,512,512),e=t.toDataURL("image/jpeg").split(",")[1])}e&&w("data:image/jpeg;base64,".concat(e))},children:"Edit Image"})]}),Object(f.jsxs)("div",{className:"form-group",children:[Object(f.jsx)("button",{onClick:function(){d.length>1?d.goBack():d.push("/")},type:"button",className:"btn btn-secondary",children:"Cancel"}),"\xa0",Object(f.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Create"})]})]})})}),y&&Object(f.jsx)(p.a,{encodedImage:"".concat(y),onCancel:function(){return w(null)},onSave:function(e){var t=e.split(",")[1];v(Object(n.a)(Object(n.a)({},O),{},{encoded_image:t})),w(null)}})]})}}).call(this,a(96).Buffer)},60:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(7),r=a(1),c=a(25),s=a(0),i=function(e){var t=e.encodedImage,a=e.onSave,i=e.onCancel,o=Object(r.useState)(null),u=Object(n.a)(o,2),l=u[0],d=u[1],b=Object(r.useState)(null),j=Object(n.a)(b,2),h=j[0],p=j[1],f=Object(r.useState)(10),m=Object(n.a)(f,2),O=m[0],v=m[1],g=Object(r.useState)("#000000"),x=Object(n.a)(g,2),y=x[0],w=x[1],k=Object(r.useState)(!1),N=Object(n.a)(k,2),I=N[0],C=N[1],S=Object(r.useState)(0),P=Object(n.a)(S,2),U=P[0],T=P[1],R=Object(r.useState)(0),E=Object(n.a)(R,2),L=E[0],D=E[1];Object(r.useEffect)((function(){var e=document.getElementById("canvas");e&&(d(e),p(e.getContext("2d")))}),[l]),Object(r.useEffect)((function(){if(h&&l)if(t){var e=new Image;e.src=t,e.onload=function(){h.drawImage(e,0,0)}}else h.fillStyle="#ffffff",h.fillRect(0,0,l.width,l.height)}),[h,l,t]);var B=function(e){if(!l)throw Error("No canvas");var t=l.getBoundingClientRect(),a=l.width/t.width,n=l.height/t.height;return{x:(e.clientX-t.left)*a,y:(e.clientY-t.top)*n}},F=function(){i()};return Object(s.jsxs)(c.a,{show:!0,onHide:F,size:"lg",children:[Object(s.jsx)(c.a.Header,{closeButton:!0,children:Object(s.jsx)(c.a.Title,{children:"Image Editor"})}),Object(s.jsxs)(c.a.Body,{children:[Object(s.jsx)("canvas",{style:{width:"100%"},id:"canvas",width:"512",height:"512",onMouseDown:function(e){if(l){C(!0);var t=B(e);T(t.x),D(t.y)}},onMouseMove:function(e){if(I&&h&&l){var t=B(e),a=t.x,n=t.y;h.beginPath(),h.moveTo(U,L),h.lineTo(a,n),h.strokeStyle=y,h.lineWidth=O,h.lineCap="round",h.stroke(),T(a),D(n)}},onMouseUp:function(e){C(!1)}}),Object(s.jsx)("div",{className:"row",children:Object(s.jsxs)("div",{className:"col-md-6",children:[Object(s.jsxs)("div",{className:"form-group",children:[Object(s.jsx)("label",{htmlFor:"brushSize",children:"Brush Size"}),Object(s.jsx)("input",{type:"range",className:"form-control",id:"brushSize",min:"1",max:"100",value:O,onChange:function(e){v(parseFloat(e.target.value))}})]}),Object(s.jsxs)("div",{className:"form-group",children:[Object(s.jsx)("label",{htmlFor:"brushColor",children:"Brush Color"}),Object(s.jsx)("input",{type:"color",className:"form-control",id:"brushColor",value:y,onChange:function(e){w(e.target.value)}})]})]})})]}),Object(s.jsxs)(c.a.Footer,{children:[Object(s.jsx)("button",{className:"btn btn-primary",onClick:function(){if(l&&h){var e=l.toDataURL("image/png");a(e)}},children:"Save"}),Object(s.jsx)("button",{className:"btn btn-secondary",onClick:F,children:"Cancel"})]})]})}},68:function(e,t,a){},89:function(e,t,a){},90:function(e,t,a){}},[[116,1,2]]]);
//# sourceMappingURL=main.d21d4516.chunk.js.map